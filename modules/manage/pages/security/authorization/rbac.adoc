= Configure Role-based Access Control
:description: Role-based access controls provide an extension to ACLs for managing permissions at scale.
:page-categories: Management, Security

Role-based Access Control (RBAC) provides a way to configure permissions for provisioned users at scale, and provides a streamlined interface to manage user access to many resources. RBAC works in conjunction with all supported authentication methods.

IMPORTANT: Redpanda only supports RBAC for self-hosted clusters. Configuration is only supported through the command line using rpk.

== RBAC

RBAC is designed to address the critical challenge of access management at scale. It alleviates the process of manually maintaining and verifying a set of raw permissions (ACLs) for a user base that may contain thousands of users. RBAC provides a method to onboard new employees easier, audit accesses faster, and adapt more readily to evolutions of usage and compliance needs.

Using RBAC, you can define roles to reflect organizational structure or job duties to implement a coherent approach to access management. This approach decouples users and permissions through the assignment of roles. This allows a one to many mapping of a given role to many users, thereby dramatically reducing the number of custom policies needed for a resource from one per user to one per group of users.

image::shared:rbac-overview.png[RBAC multiplicity]

=== RBAC terminology

Under the RBAC framework, you create *roles*, grant *permissions* to those roles, and assign the roles to *users*. When you change the permissions for a given role, all principals with that role automatically gain the modified permissions. You grant or deny permissions for a role by creating an ACL and specifying the RBAC role as the allowed or denied principal respectively.

==== Roles

A role is a named collection of ACLs which can be assigned to zero or more users. Redpanda provides two default roles, `user` and `admin`:

* `user` - All authorized users have this role by default. There are no ACLs assigned to this role until you add them. This means users have no permissions to interact with any resources you add to your Redpanda cluster until you add relevant permissions to this or another role.
* `admin` - By default, no users have this role. The default admin role provides full access to all resources in your Redpanda installation.

==== Policy conflicts

You can assign a combination of ACLs and roles to any given principal. ACLs allow permissions, deny permissions, or specify a combination of both. As a result, users may at times have role assignments with conflicting policies. If this situation arises, the user is permitted to perform an operation if and only if:

* There does not exist a DENY permission matching the operation.
* There exists an ALLOW permission matching the operation.

== Managing users and roles

Redpanda allows you to manage your RBAC configurations through both RPK. Examples of each are given here.

=== Create a role

Creating a new role is a two-step process. First you define the role, giving it a unique and descriptive name. Second, you assign one or more ACLs to allow or deny access for the new role. This defines the permissions that are inherited by all users assigned to the role.

Administrators can use rpk to create a new role by issuing the command:

[,bash]
----
rpk role create [ROLE_NAME]
----

After the role is created, administrators assign the role as the allowed principal for one or more ACLs. You can modify existing ACLs or create new ones. For example:

[,bash]
----
rpk acl create ... --allow-role [ROLE_NAME]
----

=== Delete a role

When a role is deleted, Redpanda carries out the following actions automatically:

- All role ACLs are deleted.
- All users are unassigned from role.

Using rpk, administrations delete a role by issuing the command:

[,bash]
----
rpk role delete [ROLE_NAME]
----

=== Assign a role

Administrators may assign a role to any principal created in their Redpanda instance. A principal is composed of two parts: a type and a name. Redpanda currently supports the `User` type only for principals. All principals, therefore, will have the format of `User:[name]`

Using rpk, administrations assign a role to a principal by issuing the command:

[,bash]
----
rpk role assign [ROLE_NAME] [PRINCIPAL]
----

=== Unassign a role

Administrators may remove a role from a principal without deleting the role. A principal is composed of two parts: a type and a name. Redpanda currently supports the `User` type only for principals. All principals, therefore, will have the format of `User:[name]`

Using RPK, administrators unassign a role from a principal issuing the command:

[,bash]
----
rpk role unassign [ROLE_NAME] [PRINCIPAL]
----

=== Edit a Role

After a role is created, administrators may still add additional ACLs to the role.

Using RPK, Administrators may assign the role as the allowed principal for additional ACLs. You can modify existing ACLs or create new ones. For example:

[,bash]
----
rpk acl create ... --allow-role [ROLE_NAME]
----

=== List Roles

Administrators may view a list of all roles within their Redpanda installation.

Using RPK, administrators can view a list of all actives roles by issuing the command:

[,bash]
----
rpk role list
----

=== View Role Membership

Administrators may view all principals with a given role assignment.

Using RPK, administrators can view the membership of a given role by issuing the command:

[,bash]
----
rpk role users [ROLE_NAME]
----
